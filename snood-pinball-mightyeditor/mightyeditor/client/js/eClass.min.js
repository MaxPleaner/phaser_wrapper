!function(e){"use strict";var t="undefined"!=typeof global&&global==e,n=[],o=function(){this.cbs=[]};o.prototype={release:function(e){if(this.cbs.length)for(;this.cbs.length;)this.cbs.shift()(e)},push:function(e){this.cbs.push(e)},get length(){return this.cbs.length}};var i;if(t){var r=(require("fs"),require("path"));i=function(e,t){this.loading=0,this.acc=new o},i.prototype={getScript:function(e,t){require(r.resolve(e)),t&&t(),this.onReady()},onReady:function(e){this.acc.push(e)}}}else{var c=!1;window.addEventListener("DOMContentLoaded",function(){c=!0},!1),i=function(e,t){this.loadings=0,this.acc=new o,this.cache={},this._cache={},this.className=e,this.accumulator=t},i.prototype={onReady:function(e){0===this.loadings?c?e():window.addEventListener("DOMContentLoaded",function(){e()},!1):this.acc.push(e)},_onload:function(e){this.onScriptsLoaded()},getScript:function(e,t){if(this.cache[e]&&2===this.cache[e].status)return this.loadings-=this.cache[e].cbs.length,"function"==typeof t&&t(),this.cache[e].cbs.release(),void this._onload(this);if(this.cache[e])return void("function"==typeof t&&(this.loadings++,this.cache[e].cbs.push(t)));this.cache[e]={status:1,cbs:new o},"function"==typeof t&&(this.loadings++,this.cache[e].cbs.push(t)),this.loadings++;var n=window.script=document.createElement("script");n.setAttribute("data-origin",this.className),n.setAttribute("async","async");var i=this;n.onload=function(){i.loadings-=i.cache[e].cbs.length+1,i.cache[e].cbs.release(),i.cache[e].status++,i._onload(this)},n.onreadystatechange=function(e,t,n){console.log("script",e,t,n,this)},n.onerror=function(){console.error("FATAL ERROR - onReady won't be called",n.src)},n.src=e,document.head.appendChild(n)},serialize:function(e,t){var n=[];for(var o in e)if(e.hasOwnProperty(o)){var i=t?t+"["+o+"]":o,r=e[o];n.push("object"==typeof r?this.serialize(r,i):encodeURIComponent(i)+"="+encodeURIComponent(r))}return n.join("&")},getCached:function(e,t){var n=this;if(this._cache[e]&&2===this._cache[e].status)return this.loadings-=this._cache[e].cbs.length,this._cache[e].cbs.push(t),void window.setTimeout(function(){n._cache[e].cbs.release(n._cache[e].data)},0);if(this._cache[e])return void("function"==typeof t&&this._cache[e].cbs.push(t));this._cache[e]={status:1,cbs:new o,data:null},this._cache[e].cbs.push(t);var n=this;this.get(e,function(t){n._cache[e].cbs.release(t),n._cache[e].status++,n._cache[e].data=t})},get:function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&t(n.response,n)},n.open("GET",e,!0),n.send(null)},post:function(e,t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&n(o.response,o)},o.open("POST",e,!0),o.send(JSON.stringify(t))},onScriptsLoaded:function(){if(0==this.loadings){var e=this;c?window.setTimeout(function(){e.accumulator.release(),e.acc.release()},0):window.addEventListener("DOMContentLoaded",function(){e.accumulator.release(),e.acc.release()},!1)}}}}e.createClass=function(r,c,s){if(void 0==c&&(c=e),void 0==s&&(s=r),c[r])return console.warn("Not redefined"),c[r];var a=function(){console.log("final class")},u=void 0===s?"src":s,d=new o,h=function(e,t){var n=e.split("."),o=t;n.pop();for(var i=0;i<n.length;i++)o=o[n[i]];return o},l=function(e,n,o){return t?void f(e,n,o):(y.loader.loadings++,void setTimeout(function(){y.loader.loadings--,f(e,n,function(){o&&o(),y.loader.onScriptsLoaded()})},0))},f=function(e,t,n){var o=e.split("."),i=o.pop(),r=y,c="";t=t||"";for(var s=0;s<o.length;s++)r[o[s]]=r[o[s]]||{},r=r[o[s]];return r[i]?void(n&&n()):(c=o.length>0?o.join("/")+"/":"",t=t+y.basePath+"/"+c+i+".js",void y.loader.getScript(t,n,e))},p=function(e,t){t.extend==a&&console.log("Extending final class!!!");var n=e.prototype,o={};for(var i in t.prototype){var r=Object.getOwnPropertyDescriptor(t.prototype,i);o[i]=r}e.prototype=Object.create(t.prototype,o);for(var i in t.prototype)r=Object.getOwnPropertyDescriptor(t.prototype,i),void 0!=r?void 0===r.value||(e[i]=r.value):e[i]=t.prototype[i];for(var i in n){var r=null;if(r=Object.getOwnPropertyDescriptor(n,i))if(void 0===r.value){if(r.set||r.get){var c=Object.getOwnPropertyDescriptor(t.prototype,i),s=r.set;void 0===s&&(s=c?c.set:void 0);var u=r.get;void 0===u&&(u=c?c.get:void 0),Object.defineProperty(e.prototype,i,{set:s,get:u,enumerable:!0})}}else e.prototype[i]=r.value;else e.prototype[i]=n[i]}e.__extended=!0},g=function(e){var t=y;return function(n){if("function"==typeof n)return p(e,n),e;var o=function(){var i,r=h(n,t);return i=r[n.split(".").pop()],i&&i.__extended?void p(e,i):void d.push(o)};return l(n,null,o),e}},v=function(e){e.extend=g(e),e["final"]=y["final"]},y=function(e,t){if(t){var o;for(var i in t)o=Object.getOwnPropertyDescriptor(t,i),"function"!=typeof o.value||(e[i]=t[i]);e.prototype=t}for(v(e),e.__extended=!1,n.length||(e.__extended=!0);n.length;)e.extend(n.shift());return e};return y.basePath=u,y.emptyFn=function(){},y.scope=c,y.scopeName="",y.require=function(e,t,n){return l(e,t,n),this},y.include=function(e,t,n){return l(e,t,n),this},y.requireFile=function(e,t){return y.loader.getScript(e,t),this},y.requireFiles=function(e,t){for(var n=0;n<e.length-1;n++)y.loader.getScript(e[n]);return y.loader.getScript(e[include.length-1],t),this},y.requireFilesSync=function(e,t){var n=function(){var o=e.shift();console.log("getting",o),e.length>0?y.loader.getScript(o,n):y.loader.getScript(o,t)};return n(),this},y.namespace=function(e){for(var t=e.split("."),n=y,o=0;o<t.length;o++)n[t[o]]=n[t[o]]||{},n=n[t[o]];y.scopeName=t[o-1],y.scope=n},y.removeDebug=function(){for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var o=t[n],i=o.getAttribute("data-origin");i==r&&(t[n].parentNode.removeChild(t[n]),n--)}delete e.Class},y.extend=function(e){return n.push(e),this},y.loader=new i(r,d),y.onReady=function(e){y.loader.onReady(e)},y["final"]=function(){this.extend=a},y.define=y,c[r]=y,y}}("undefined"==typeof window?global:window);